"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[172],{53213:function(me,R,r){r.r(R),r.d(R,{default:function(){return le}});var U=r(27424),C=r.n(U),N=r(17061),l=r.n(N),V=r(42122),G=r.n(V),z=r(17156),p=r.n(z),M=r(2618),W=r(51042),Y=r(66958),K=r(95782),H=r(2236),J=r(37476),B=r(5966),P=r(64317),Q=r(1656),m=r(85065),f=r(2453),A=r(71577),X=r(85265),F=r(67294),Z=r(62113),k=r(90672),q=r(86615),_=r(22452),ee=r(69400),a=r(85893),ae=function(s){var n=(0,m.useIntl)();return(0,a.jsxs)(Z.L,{stepsProps:{size:"small"},stepsFormRender:function(v,e){return(0,a.jsx)(ee.Z,{width:640,bodyStyle:{padding:"32px 40px 48px"},destroyOnClose:!0,title:"\u4FE1\u6807\u914D\u7F6E",open:s.updateModalOpen,footer:e,onCancel:function(){s.onCancel()},children:v})},onFinish:s.onSubmit,children:[(0,a.jsxs)(Z.L.StepForm,{initialValues:{id:s.values.id,name:s.values.name},title:n.formatMessage({id:"pages.searchTable.updateForm.basicConfig",defaultMessage:"\u57FA\u672C\u4FE1\u606F"}),children:[(0,a.jsx)(B.Z,{name:"id",label:"beacon id",width:"md",rules:[{required:!0,message:"\u8BF7\u8F93\u5165beacon id!"}]}),(0,a.jsx)(k.Z,{name:"name",width:"md",label:"beacon name",placeholder:n.formatMessage({id:"pages.searchTable.updateForm.ruleDesc.descPlaceholder",defaultMessage:"\u8BF7\u8F93\u5165\u81F3\u5C11\u4E94\u4E2A\u5B57\u7B26"}),rules:[{required:!0,message:(0,a.jsx)(m.FormattedMessage,{id:"pages.searchTable.updateForm.ruleDesc.descRules",defaultMessage:"\u8BF7\u8F93\u5165\u81F3\u5C11\u4E94\u4E2A\u5B57\u7B26\u7684\u89C4\u5219\u63CF\u8FF0\uFF01"}),min:5}]})]}),(0,a.jsxs)(Z.L.StepForm,{initialValues:{classroom:s.values.classroom,template:"0"},title:"\u914D\u7F6E\u6559\u5BA4",children:[(0,a.jsx)(P.Z,{name:"classroom",width:"md",label:"\u9009\u62E9\u6559\u5BA4",valueEnum:{0:"\u5DE5\u7A0B\u7BA1224",1:"\u5DE5\u7A0B\u7BA1315",2:"\u5DE5\u7A0B\u7BA1324"}}),(0,a.jsx)(q.Z.Group,{name:"type",label:"\u6559\u5BA4\u7C7B\u578B",options:[{value:"0",label:"\u5927"},{value:"1",label:"\u5C0F"}]})]}),(0,a.jsx)(Z.L.StepForm,{initialValues:{type:"1",frequency:"month"},title:"\u8BBE\u5B9A\u5B89\u88C5\u5468\u671F",children:(0,a.jsx)(_.Z,{name:"time",width:"md",label:n.formatMessage({id:"pages.searchTable.updateForm.schedulingPeriod.timeLabel",defaultMessage:"\u5F00\u59CB\u65F6\u95F4"}),rules:[{required:!0,message:(0,a.jsx)(m.FormattedMessage,{id:"pages.searchTable.updateForm.schedulingPeriod.timeRules",defaultMessage:"\u8BF7\u9009\u62E9\u5F00\u59CB\u65F6\u95F4\uFF01"})}]})})]})},re=ae,ne=function(){var g=p()(l()().mark(function s(n){var d;return l()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return d=f.ZP.loading("\u6B63\u5728\u6DFB\u52A0"),e.prev=1,console.log(n),e.next=5,(0,M.x2)(G()({},n));case 5:return d(),f.ZP.success("Added successfully"),e.abrupt("return",!0);case 10:return e.prev=10,e.t0=e.catch(1),d(),f.ZP.error("Adding failed, please try again!"),e.abrupt("return",!1);case 15:case"end":return e.stop()}},s,null,[[1,10]])}));return function(n){return g.apply(this,arguments)}}(),te=function(){var g=p()(l()().mark(function s(n){var d;return l()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return d=f.ZP.loading("Configuring"),e.prev=1,e.next=4,(0,M.D7)({name:n.name,desc:n.classroom,key:n.id});case 4:return d(),f.ZP.success("Configuration is successful"),e.abrupt("return",!0);case 9:return e.prev=9,e.t0=e.catch(1),d(),f.ZP.error("Configuration failed, please try again!"),e.abrupt("return",!1);case 14:case"end":return e.stop()}},s,null,[[1,9]])}));return function(n){return g.apply(this,arguments)}}(),se=function(){var g=p()(l()().mark(function s(n){var d;return l()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(d=f.ZP.loading("\u6B63\u5728\u5220\u9664"),n){e.next=3;break}return e.abrupt("return",!0);case 3:return e.prev=3,e.next=6,(0,M.DV)({key:n.map(function(T){return T.id})});case 6:return d(),f.ZP.success("Deleted successfully and will refresh soon"),e.abrupt("return",!0);case 11:return e.prev=11,e.t0=e.catch(3),d(),f.ZP.error("Delete failed, please try again"),e.abrupt("return",!1);case 16:case"end":return e.stop()}},s,null,[[3,11]])}));return function(n){return g.apply(this,arguments)}}(),ue=function(){var s=(0,F.useState)(!1),n=C()(s,2),d=n[0],v=n[1],e=(0,F.useState)(!1),T=C()(e,2),de=T[0],b=T[1],ie=(0,F.useState)(!1),E=C()(ie,2),w=E[0],D=E[1],j=(0,F.useRef)(),oe=(0,F.useState)(),I=C()(oe,2),o=I[0],x=I[1],ce=(0,F.useState)([]),$=C()(ce,2),S=$[0],O=$[1],fe=(0,m.useIntl)(),L=[{title:"id",dataIndex:"id",tip:"The rule name is the unique key",render:function(u,t){return(0,a.jsx)("a",{onClick:function(){x(t),D(!0)},children:u})}},{title:"\u5B66\u53F7",dataIndex:"studentNo",valueType:"textarea"},{title:"\u59D3\u540D",dataIndex:"studentName",valueType:"textarea"},{title:"\u7B7E\u5230\u6559\u5BA4",dataIndex:"classroom",valueType:"textarea"},{title:"\u7B7E\u5230\u65F6\u95F4",dataIndex:"createdTime",valueType:"dateTime"},{title:"\u66F4\u65B0\u65F6\u95F4",dataIndex:"lastUpdatedTime",valueType:"dateTime"},{title:"operation",dataIndex:"option",valueType:"option",render:function(u,t){return[(0,a.jsx)("a",{onClick:function(){b(!0),x(t)},children:(0,a.jsx)(m.FormattedMessage,{id:"pages.searchTable.config",defaultMessage:"Configuration"})},"config")]}}];return(0,a.jsxs)(Y._z,{children:[(0,a.jsx)(K.Z,{headerTitle:"\u7B7E\u5230\u660E\u7EC6",actionRef:j,rowKey:"key",search:{labelWidth:120},toolBarRender:function(){return[(0,a.jsxs)(A.ZP,{type:"primary",onClick:function(){v(!0)},children:[(0,a.jsx)(W.Z,{})," ",(0,a.jsx)(m.FormattedMessage,{id:"pages.checkin.searchTable.new",defaultMessage:"\u8865\u7B7E"})]},"primary")]},request:M.aq,columns:L,rowSelection:{onChange:function(u,t){O(t)}}}),(S==null?void 0:S.length)>0&&(0,a.jsx)(H.S,{extra:(0,a.jsxs)("div",{children:[(0,a.jsx)(m.FormattedMessage,{id:"pages.searchTable.chosen",defaultMessage:"Chosen"})," ",(0,a.jsx)("a",{style:{fontWeight:600},children:S.length})," ",(0,a.jsx)(m.FormattedMessage,{id:"pages.searchTable.item",defaultMessage:"\u9879"}),"\xA0\xA0"]}),children:(0,a.jsx)(A.ZP,{onClick:p()(l()().mark(function i(){var u,t;return l()().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return y.next=2,se(S);case 2:O([]),(u=j.current)===null||u===void 0||(t=u.reloadAndRest)===null||t===void 0||t.call(u);case 4:case"end":return y.stop()}},i)})),children:(0,a.jsx)(m.FormattedMessage,{id:"pages.searchTable.batchDeletion",defaultMessage:"Batch deletion"})})}),(0,a.jsxs)(J.Y,{title:"\u8865\u7B7E",width:"400px",open:d,onOpenChange:v,onFinish:function(){var i=p()(l()().mark(function u(t){var h;return l()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,ne(t);case 2:h=c.sent,h&&(v(!1),j.current&&j.current.reload());case 4:case"end":return c.stop()}},u)}));return function(u){return i.apply(this,arguments)}}(),children:[(0,a.jsx)(B.Z,{rules:[{required:!0,message:"\u5B66\u53F7\u4E3A\u5FC5\u586B"}],width:"md",name:"id",label:"\u5B66\u53F7"}),(0,a.jsx)(B.Z,{rules:[{required:!0,message:"\u59D3\u540D\u4E3A\u5FC5\u586B"}],width:"md",name:"name",label:"\u59D3\u540D"}),(0,a.jsx)(P.Z,{name:"classroom",width:"md",label:"\u9009\u62E9\u6559\u5BA4",valueEnum:{\u5DE5\u7A0B\u7BA1214:"\u5DE5\u7A0B\u7BA1214",\u5DE5\u7A0B\u7BA1315:"\u5DE5\u7A0B\u7BA1315",\u5DE5\u7A0B\u7BA1324:"\u5DE5\u7A0B\u7BA1324"}})]}),(0,a.jsx)(re,{onSubmit:function(){var i=p()(l()().mark(function u(t){var h;return l()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,te(t);case 2:h=c.sent,h&&(b(!1),x(void 0),j.current&&j.current.reload());case 4:case"end":return c.stop()}},u)}));return function(u){return i.apply(this,arguments)}}(),onCancel:function(){b(!1),w||x(void 0)},updateModalOpen:de,values:o||{}}),(0,a.jsx)(X.Z,{width:600,open:w,onClose:function(){x(void 0),D(!1)},closable:!1,children:(o==null?void 0:o.studentName)&&(0,a.jsx)(Q.vY,{column:2,title:o==null?void 0:o.studentName,request:p()(l()().mark(function i(){return l()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",{data:o||{}});case 1:case"end":return t.stop()}},i)})),params:{id:o==null?void 0:o.studentName},columns:L})})]})},le=ue}}]);
