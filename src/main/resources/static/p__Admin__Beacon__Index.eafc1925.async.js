"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[920],{8609:function(fe,B,r){r.r(B),r.d(B,{default:function(){return le}});var U=r(27424),C=r.n(U),V=r(17061),l=r.n(V),G=r(42122),z=r.n(G),N=r(17156),p=r.n(N),b=r(2618),W=r(51042),Y=r(66958),K=r(95782),H=r(2236),J=r(37476),F=r(5966),w=r(64317),Q=r(1656),m=r(85065),f=r(2453),P=r(71577),X=r(85265),x=r(67294),Z=r(62113),k=r(90672),q=r(86615),_=r(22452),ee=r(69400),a=r(85893),ae=function(s){var n=(0,m.useIntl)();return(0,a.jsxs)(Z.L,{stepsProps:{size:"small"},stepsFormRender:function(h,e){return(0,a.jsx)(ee.Z,{width:640,bodyStyle:{padding:"32px 40px 48px"},destroyOnClose:!0,title:"\u4FE1\u6807\u914D\u7F6E",open:s.updateModalOpen,footer:e,onCancel:function(){s.onCancel()},children:h})},onFinish:s.onSubmit,children:[(0,a.jsxs)(Z.L.StepForm,{initialValues:{id:s.values.id,name:s.values.name},title:n.formatMessage({id:"pages.searchTable.updateForm.basicConfig",defaultMessage:"\u57FA\u672C\u4FE1\u606F"}),children:[(0,a.jsx)(F.Z,{name:"id",label:"beacon id",width:"md",rules:[{required:!0,message:"\u8BF7\u8F93\u5165beacon id!"}]}),(0,a.jsx)(k.Z,{name:"name",width:"md",label:"beacon name",placeholder:n.formatMessage({id:"pages.searchTable.updateForm.ruleDesc.descPlaceholder",defaultMessage:"\u8BF7\u8F93\u5165\u81F3\u5C11\u4E94\u4E2A\u5B57\u7B26"}),rules:[{required:!0,message:(0,a.jsx)(m.FormattedMessage,{id:"pages.searchTable.updateForm.ruleDesc.descRules",defaultMessage:"\u8BF7\u8F93\u5165\u81F3\u5C11\u4E94\u4E2A\u5B57\u7B26\u7684\u89C4\u5219\u63CF\u8FF0\uFF01"}),min:5}]})]}),(0,a.jsxs)(Z.L.StepForm,{initialValues:{classroom:s.values.classroom,template:"0"},title:"\u914D\u7F6E\u6559\u5BA4",children:[(0,a.jsx)(w.Z,{name:"classroom",width:"md",label:"\u9009\u62E9\u6559\u5BA4",valueEnum:{0:"\u5DE5\u7A0B\u7BA1224",1:"\u5DE5\u7A0B\u7BA1315",2:"\u5DE5\u7A0B\u7BA1324"}}),(0,a.jsx)(q.Z.Group,{name:"type",label:"\u6559\u5BA4\u7C7B\u578B",options:[{value:"0",label:"\u5927"},{value:"1",label:"\u5C0F"}]})]}),(0,a.jsx)(Z.L.StepForm,{initialValues:{type:"1",frequency:"month"},title:"\u8BBE\u5B9A\u5B89\u88C5\u5468\u671F",children:(0,a.jsx)(_.Z,{name:"time",width:"md",label:n.formatMessage({id:"pages.searchTable.updateForm.schedulingPeriod.timeLabel",defaultMessage:"\u5F00\u59CB\u65F6\u95F4"}),rules:[{required:!0,message:(0,a.jsx)(m.FormattedMessage,{id:"pages.searchTable.updateForm.schedulingPeriod.timeRules",defaultMessage:"\u8BF7\u9009\u62E9\u5F00\u59CB\u65F6\u95F4\uFF01"})}]})})]})},re=ae,ne=function(){var g=p()(l()().mark(function s(n){var i;return l()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=f.ZP.loading("\u6B63\u5728\u6DFB\u52A0"),e.prev=1,console.log(n),e.next=5,(0,b.x2)(z()({},n));case 5:return i(),f.ZP.success("Added successfully"),e.abrupt("return",!0);case 10:return e.prev=10,e.t0=e.catch(1),i(),f.ZP.error("Adding failed, please try again!"),e.abrupt("return",!1);case 15:case"end":return e.stop()}},s,null,[[1,10]])}));return function(n){return g.apply(this,arguments)}}(),te=function(){var g=p()(l()().mark(function s(n){var i;return l()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=f.ZP.loading("Configuring"),e.prev=1,e.next=4,(0,b.D7)({name:n.name,desc:n.classroom,key:n.id});case 4:return i(),f.ZP.success("Configuration is successful"),e.abrupt("return",!0);case 9:return e.prev=9,e.t0=e.catch(1),i(),f.ZP.error("Configuration failed, please try again!"),e.abrupt("return",!1);case 14:case"end":return e.stop()}},s,null,[[1,9]])}));return function(n){return g.apply(this,arguments)}}(),se=function(){var g=p()(l()().mark(function s(n){var i;return l()().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=f.ZP.loading("\u6B63\u5728\u5220\u9664"),n){e.next=3;break}return e.abrupt("return",!0);case 3:return e.prev=3,e.next=6,(0,b.DV)({key:n.map(function(S){return S.id})});case 6:return i(),f.ZP.success("Deleted successfully and will refresh soon"),e.abrupt("return",!0);case 11:return e.prev=11,e.t0=e.catch(3),i(),f.ZP.error("Delete failed, please try again"),e.abrupt("return",!1);case 16:case"end":return e.stop()}},s,null,[[3,11]])}));return function(n){return g.apply(this,arguments)}}(),ue=function(){var s=(0,x.useState)(!1),n=C()(s,2),i=n[0],h=n[1],e=(0,x.useState)(!1),S=C()(e,2),ie=S[0],R=S[1],de=(0,x.useState)(!1),A=C()(de,2),E=A[0],D=A[1],j=(0,x.useRef)(),oe=(0,x.useState)(),I=C()(oe,2),o=I[0],T=I[1],ce=(0,x.useState)([]),$=C()(ce,2),M=$[0],O=$[1],me=(0,m.useIntl)(),L=[{title:"beacon id",dataIndex:"id",tip:"The rule name is the unique key",render:function(u,t){return(0,a.jsx)("a",{onClick:function(){T(t),D(!0)},children:u})}},{title:"beacon name",dataIndex:"name",valueType:"textarea"},{title:"classroom",dataIndex:"classroom",valueType:"textarea"},{title:"x",dataIndex:"x",valueType:"textarea"},{title:"y",dataIndex:"y",valueType:"textarea"},{title:"n",dataIndex:"n",valueType:"textarea"},{title:"operation",dataIndex:"option",valueType:"option",render:function(u,t){return[(0,a.jsx)("a",{onClick:function(){R(!0),T(t)},children:(0,a.jsx)(m.FormattedMessage,{id:"pages.searchTable.config",defaultMessage:"Configuration"})},"config")]}}];return(0,a.jsxs)(Y._z,{children:[(0,a.jsx)(K.Z,{headerTitle:me.formatMessage({id:"pages.beacon.searchTable.title",defaultMessage:"Enquiry form"}),actionRef:j,rowKey:"key",search:{labelWidth:120},toolBarRender:function(){return[(0,a.jsxs)(P.ZP,{type:"primary",onClick:function(){h(!0)},children:[(0,a.jsx)(W.Z,{})," ",(0,a.jsx)(m.FormattedMessage,{id:"pages.searchTable.new",defaultMessage:"New"})]},"primary")]},request:b.Ne,columns:L,rowSelection:{onChange:function(u,t){O(t)}}}),(M==null?void 0:M.length)>0&&(0,a.jsx)(H.S,{extra:(0,a.jsxs)("div",{children:[(0,a.jsx)(m.FormattedMessage,{id:"pages.searchTable.chosen",defaultMessage:"Chosen"})," ",(0,a.jsx)("a",{style:{fontWeight:600},children:M.length})," ",(0,a.jsx)(m.FormattedMessage,{id:"pages.searchTable.item",defaultMessage:"\u9879"}),"\xA0\xA0"]}),children:(0,a.jsx)(P.ZP,{onClick:p()(l()().mark(function d(){var u,t;return l()().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return y.next=2,se(M);case 2:O([]),(u=j.current)===null||u===void 0||(t=u.reloadAndRest)===null||t===void 0||t.call(u);case 4:case"end":return y.stop()}},d)})),children:(0,a.jsx)(m.FormattedMessage,{id:"pages.searchTable.batchDeletion",defaultMessage:"Batch deletion"})})}),(0,a.jsxs)(J.Y,{title:"\u65B0\u5EFA\u4FE1\u6807",width:"400px",open:i,onOpenChange:h,onFinish:function(){var d=p()(l()().mark(function u(t){var v;return l()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,ne(t);case 2:v=c.sent,v&&(h(!1),j.current&&j.current.reload());case 4:case"end":return c.stop()}},u)}));return function(u){return d.apply(this,arguments)}}(),children:[(0,a.jsx)(F.Z,{rules:[{required:!0,message:"\u4FE1\u6807ID\u4E3A\u5FC5\u586B"}],width:"md",name:"id",label:"\u4FE1\u6807ID"}),(0,a.jsx)(F.Z,{rules:[{required:!0,message:"\u4FE1\u6807\u540D\u79F0\u4E3A\u5FC5\u586B"}],width:"md",name:"name",label:"\u4FE1\u6807\u540D\u79F0"}),(0,a.jsx)(w.Z,{name:"classroom",width:"md",label:"\u9009\u62E9\u6559\u5BA4",valueEnum:{\u5DE5\u7A0B\u7BA1214:"\u5DE5\u7A0B\u7BA1214",\u5DE5\u7A0B\u7BA1315:"\u5DE5\u7A0B\u7BA1315",\u5DE5\u7A0B\u7BA1324:"\u5DE5\u7A0B\u7BA1324"}}),(0,a.jsx)(F.Z,{width:"md",name:"x",label:"x"}),(0,a.jsx)(F.Z,{width:"md",name:"y",label:"y"}),(0,a.jsx)(F.Z,{width:"md",name:"n",label:"n"})]}),(0,a.jsx)(re,{onSubmit:function(){var d=p()(l()().mark(function u(t){var v;return l()().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,te(t);case 2:v=c.sent,v&&(R(!1),T(void 0),j.current&&j.current.reload());case 4:case"end":return c.stop()}},u)}));return function(u){return d.apply(this,arguments)}}(),onCancel:function(){R(!1),E||T(void 0)},updateModalOpen:ie,values:o||{}}),(0,a.jsx)(X.Z,{width:600,open:E,onClose:function(){T(void 0),D(!1)},closable:!1,children:(o==null?void 0:o.name)&&(0,a.jsx)(Q.vY,{column:2,title:o==null?void 0:o.name,request:p()(l()().mark(function d(){return l()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",{data:o||{}});case 1:case"end":return t.stop()}},d)})),params:{id:o==null?void 0:o.name},columns:L})})]})},le=ue}}]);
